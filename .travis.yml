jobs:
  include:
  - stage: deploy-native-mac
    os: osx
    language: java
    osx_image: xcode9.3
    script:
    - "travis_wait 40 ./gradlew native-cli:distro"
    deploy:
    - provider: script
      skip_cleanup: true
      script: "./gradlew native-cli:uploadDistro"
      on:
        branch: master
  - stage: deploy-native-linux
    os: linux
    language: java
    jdk: openjdk8
    script:
    - "travis_wait 40 ./gradlew native-cli:distro"
    deploy:
    - provider: script
      skip_cleanup: true
      script: "./gradlew native-cli:uploadDistro"
      on:
        branch: master
  - stage: deploy-native-windows
    os: windows
    language: shell
    before_install:
      - powershell -command 'Set-MpPreference -DisableRealtimeMonitoring $true'
      - git clone https://github.com/portapps/portapps ${TRAVIS_BUILD_DIR}/../portapps
      - source ${TRAVIS_BUILD_DIR}/../portapps/.travis/prepare.sh
      - bash ${TRAVIS_BUILD_DIR}/../portapps/.travis/java.sh
    script:
      - "./gradlew native-cli:distro"
    deploy:
      - provider: script
        skip_cleanup: true
        script: "./gradlew native-cli:uploadDistro"
        on:
          branch: master
#Token is encrypted
notifications:
  slack:
    rooms:
      secure: viupY4F9IIcJhOrNE7u2j+vv553GdFLHUPk2CFxJ8SqiGR8oHHzkBzwJ/sUOmjzZ4kct3xvwpBq6RkuuyMPRmVF+paSl5L5jIUBjMsTs07UtaJLYrA6i2s1yvLV7ILI0302Atu2wEb65rgMJIDU3Q/HAGGe4P1y2HK7DEXJ3dHBtG0pzjSD8XoRtSwMDD/e6sjBeWduDkhUkC6vwyjXmh7oyzMQ3MtjzRyjLAYo361zKMHmbfey9CwGZZLrrPO0jU2Bz6NTLV6iEvy0tC8qf/dTd65bw5J3uNhN3CfQ2C29mYZybNF0Jfs1tce4UT10whfDbudEGHU+J95m8ED3bMuqBFN0CvJiNJEUuzxK/6lyS12mHJtOnzNWsRymAc6+yC4AKZi0UpOpYK+bMTHHt3zjixBttzHySme29FEVevV8gZOgygn3w95tIcRA4CPjotSBCReelFBILbILRyYJ6tAM/pqUqBukJPdU6Gyuj1PsIMCPoR6HmRBgZ+EOQl3CJp1RPkjaZQA0x42qSwnJO/pOb8X4MR+n7iZxCylxw98dQUX7+hJ4SiEQhw3pANg0E89qS36G+JOzoGpCR6IZWA0HLUOaa/Me5LLJZeffyUSqOEj/lDQsfCYBHXwJQgzqRQ7t6vdEad14YYOlgpT6w4mOpe1NNELTH3FxqHWHD7Vs=
